import{a as K}from"./chunk-HCF5RDTS.js";import{c as J,d as q}from"./chunk-3RE7YTIY.js";import{b as L,f as R,k as W,r as z}from"./chunk-Q674NIMA.js";import{a as G}from"./chunk-FIRHHLGJ.js";import{a as B,c as Q}from"./chunk-7YSBFMG3.js";import{b as D}from"./chunk-EKD5RMQ3.js";import{$b as I,Jb as r,Kb as s,Lb as p,Mb as M,Nb as b,Pb as k,Sb as x,Ub as w,Xa as P,Xc as j,Yc as F,Zc as V,_b as S,aa as O,ac as E,bb as o,ec as y,ga as l,gd as H,ic as A,jc as T,ka as m,kc as N,mc as f,ta as d,tb as _,ua as g,yb as a}from"./chunk-X7VXIKXH.js";var u=class t{static \u0275fac=function(e){return new(e||t)};static \u0275cmp=m({type:t,selectors:[["app-skeleton"]],standalone:!0,features:[f],decls:6,vars:0,consts:[[1,"user-card"],[1,"name1","skeleton"],[1,"name2","skeleton"],[1,"name3","skeleton"],[1,"name4","skeleton"]],template:function(e,i){e&1&&(r(0,"div",0),p(1,"div",1)(2,"p",2)(3,"p",3)(4,"p",4)(5,"div"),s())},styles:["*[_ngcontent-%COMP%]{margin:0}.user-card[_ngcontent-%COMP%]{padding:8px 16px;max-width:100%;min-height:10rem;text-align:center;font-family:verdana}.user-card[_ngcontent-%COMP%]   .profile-pic[_ngcontent-%COMP%]{height:100px;width:100px;border-radius:100%;margin:auto}.user-card[_ngcontent-%COMP%]   .name1[_ngcontent-%COMP%]{max-width:25%;min-height:14px;border-radius:10px}.user-card[_ngcontent-%COMP%]   .name2[_ngcontent-%COMP%]{max-width:50%;min-height:14px;border-radius:10px}.user-card[_ngcontent-%COMP%]   .name3[_ngcontent-%COMP%]{max-width:75%;min-height:14px;border-radius:10px}.user-card[_ngcontent-%COMP%]   .name4[_ngcontent-%COMP%]{max-width:100%;min-height:14px;border-radius:10px}.user-card[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin:16px 0}.skeleton[_ngcontent-%COMP%]{background-color:#a5a5a5;animation:_ngcontent-%COMP%_skeleton-animation 1s infinite ease-in-out}@keyframes _ngcontent-%COMP%_skeleton-animation{0%{opacity:.2}50%{opacity:.5}to{opacity:.2}}"]})};var h=class t{http=l(D);endpoint=G.apiendpoint;constructor(){}enviarPromptAI(n){let e={messages:n};return this.http.post(`${this.endpoint}/ai`,e,{withCredentials:!0})}static \u0275fac=function(e){return new(e||t)};static \u0275prov=O({token:t,factory:t.\u0275fac,providedIn:"root"})};var Z=["chatHistory"];function $(t,n){if(t&1&&(M(0),r(1,"div",9),p(2,"p",10),s(),p(3,"br")(4,"br")(5,"br"),b()),t&2){let e=n.$implicit,i=w();o(),a("ngClass",e.actor=="model"?"bot-message":"user-message"),o(),a("innerHTML",i.formatearTexto(e.message),P)}}function ee(t,n){t&1&&(M(0),p(1,"app-skeleton"),b())}function te(t,n){t&1&&(r(0,"div",11)(1,"p"),y(2,"El asistente est\xE1 pensando..."),s()())}var X=class t{historialChat;geminiService=l(h);snackbar=l(K);prompt="";loading=!1;chatMessages=[];ngOnInit(){this.chatMessages=JSON.parse(sessionStorage.getItem("aichat")||"[]")}enviarMensajeAi(){if(this.prompt&&!this.loading){this.loading=!0,this.historialChat.nativeElement.scrollTop=this.historialChat.nativeElement.scrollHeight;let n=this.prompt;this.chatMessages.push({actor:"user",message:n}),this.prompt="",this.geminiService.enviarPromptAI([...this.chatMessages]).subscribe({next:e=>{this.chatMessages.push({actor:"model",message:e.candidates[0].content.parts[0].text}),this.historialChat.nativeElement.scrollTop=this.historialChat.nativeElement.scrollHeight,this.loading=!1,sessionStorage.setItem("aichat",JSON.stringify(this.chatMessages))},error:e=>{this.loading=!1,this.snackbar.open("El asistente no puede responder. Int\xE9ntelo m\xE1s tarde.","Aceptar",{duration:3e3,panelClass:".snackerror"})}})}}formatearTexto(n){return n.replaceAll("*","")}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=m({type:t,selectors:[["app-aichat"]],viewQuery:function(e,i){if(e&1&&S(Z,5),e&2){let c;I(c=E())&&(i.historialChat=c.first)}},standalone:!0,features:[f],decls:10,vars:6,consts:[["chatHistory",""],[1,"chat-container"],[1,"chat-history"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","pensando",4,"ngIf"],[1,"chat-inputs"],["matInput","","type","text","id","message-input","placeholder","Escribe tu mensaje...","autocomplete","off",3,"keyup.enter","ngModelChange","ngModel","disabled"],["mat-flat-button","","id","send-button",3,"click","disabled"],[1,"messages",3,"ngClass"],[1,"responses",3,"innerHTML"],[1,"pensando"]],template:function(e,i){if(e&1){let c=k();r(0,"div",1)(1,"div",2,0),_(3,$,6,2,"ng-container",3)(4,ee,2,0,"ng-container",4),s(),_(5,te,3,0,"div",5),r(6,"div",6)(7,"input",7),x("keyup.enter",function(){return d(c),g(i.enviarMensajeAi())}),N("ngModelChange",function(C){return d(c),T(i.prompt,C)||(i.prompt=C),g(C)}),s(),r(8,"button",8),x("click",function(){return d(c),g(i.enviarMensajeAi())}),y(9,"Enviar"),s()()()}e&2&&(o(3),a("ngForOf",i.chatMessages),o(),a("ngIf",i.loading),o(),a("ngIf",i.loading),o(2),A("ngModel",i.prompt),a("disabled",i.loading),o(),a("disabled",i.loading))},dependencies:[Q,B,q,J,z,L,R,W,u,H,j,F,V],styles:[".chat-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-grow:1;padding:10px;height:65vh}.mat-dialog-container[_ngcontent-%COMP%]{overflow-y:hidden}.chat-history[_ngcontent-%COMP%]{flex-grow:1;overflow-y:auto;padding:10px;height:50vh;margin:2rem 0}.chat-message[_ngcontent-%COMP%]{margin-bottom:10px;display:flex;flex-direction:column}.chat-message.sent[_ngcontent-%COMP%]{justify-content:flex-end;align-items:flex-start}.chat-message.received[_ngcontent-%COMP%]{justify-content:flex-start;align-items:flex-end}.chat-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:10px;border-radius:5px;background-color:#fff;box-shadow:0 1px 3px #0000001a}.chat-message.sent[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{background-color:#e0e0e0}.chat-inputs[_ngcontent-%COMP%]{display:flex;gap:1rem;position:sticky;bottom:0}#message-input[_ngcontent-%COMP%]{flex-grow:1;padding:10px;border:1px solid #ccc;border-radius:5px}#send-button[_ngcontent-%COMP%]{padding:10px 20px;background-color:var(--lightbrown);color:#fff;border:none;border-radius:5px;cursor:pointer}.responses[_ngcontent-%COMP%]{padding:0 .5rem;white-space:pre-line!important}.messages[_ngcontent-%COMP%]{clear:both;border:1px solid rgba(0,0,0,.1098039216);padding:10px;border-radius:10px;font-size:14px;line-height:2;font-style:italic;margin-bottom:1rem}.bot-message[_ngcontent-%COMP%]{background-color:var(--lightbrown);color:#fff;text-align:start;float:left;margin-bottom:1rem}.user-message[_ngcontent-%COMP%]{text-align:end;float:right;margin-bottom:1rem}.blue[_ngcontent-%COMP%]{color:#00f;background:#0000ff24}.green[_ngcontent-%COMP%]{color:green;background:#80808017}#send-button[_ngcontent-%COMP%]:disabled{background-color:gray;cursor:not-allowed}.pensando[_ngcontent-%COMP%]{text-align:center;padding-bottom:1rem;animation:_ngcontent-%COMP%_pensando-animation 1s infinite ease-in-out}@keyframes _ngcontent-%COMP%_pensando-animation{0%{opacity:.2}50%{opacity:.5}to{opacity:.2}}"]})};export{X as a};

import{a as ve}from"./chunk-4XHOZ4BJ.js";import{a as Ce}from"./chunk-4KGD2F2G.js";import{b as be}from"./chunk-6IJVIIZO.js";import"./chunk-NAR25S56.js";import{a as de,b as ue}from"./chunk-FFMKZHPZ.js";import{a as ge}from"./chunk-F4DSBIY5.js";import{a as fe}from"./chunk-HCF5RDTS.js";import{a as he}from"./chunk-3TZ6EMP4.js";import{a as W,c as ce,d as pe}from"./chunk-3RE7YTIY.js";import{a as le,e as se,f as me}from"./chunk-Y6YWBKM7.js";import{b as X,d as s,f as Y,g as Z,h as ee,j as d,l as te,o as ne,p as oe,q as ie,r as ae,s as re}from"./chunk-Q674NIMA.js";import"./chunk-MUSOTDIH.js";import{a as K}from"./chunk-ABJ3EAOD.js";import{c as q,d as G}from"./chunk-C2S65IAN.js";import{a as j,b as $,c as J}from"./chunk-7YSBFMG3.js";import"./chunk-I2N33OYR.js";import"./chunk-CARY4E7O.js";import{j as H,ka as Q}from"./chunk-EKD5RMQ3.js";import{$b as P,Eb as k,Hb as F,Ib as I,Jb as n,Kb as e,Lb as c,Mb as A,Nb as N,Pb as x,Sb as h,Ub as v,Ya as E,Zc as V,_b as M,ac as y,ad as U,bb as m,d as w,dc as D,e as O,ec as i,fc as R,ga as u,gd as B,ka as S,mc as L,oc as T,ta as g,tb as C,ua as f,vc as z,yb as p}from"./chunk-X7VXIKXH.js";var xe=["AIchat"],Me=["chatHistory"],Pe=(a,o)=>o.id,ye=a=>({"margin-top":a});function we(a,o){if(a&1){let t=x();A(0),c(1,"img",28),n(2,"button",29),h("click",function(){let l;g(t);let b=v(),_=D(45);return _.value="",f((l=b.postForm.get("imagen"))==null?null:l.setValue(null))}),n(3,"mat-icon"),i(4,"close"),e()(),N()}if(a&2){let t=v();m(),p("src",t.postForm.get("imagen").value,E)}}function Oe(a,o){a&1&&(n(0,"div",30)(1,"mat-icon",31),i(2,"file_upload"),e(),n(3,"button",32),i(4,"Browser"),e(),n(5,"small",33),i(6,"Arrastra la imagen aqu\xED"),e()())}function Se(a,o){if(a&1&&(n(0,"mat-option",34),i(1),e()),a&2){let t=o.$implicit;p("value",t.id),m(),R(t.nombre)}}function Ee(a,o){if(a&1&&F(0,Se,2,2,"mat-option",34,Pe),a&2){let t=v();I(t.categorias)}}function ke(a,o){a&1&&c(0,"app-aichat")}var _e=class a{categoriasService=u(Ce);postService=u(ge);dialogService=u(be);responsiveService=u(he);snackbar=u(fe);router=u(q);title=u(H);categorias=[];positionDialogueRight="5rem";positionDialogueLeft="";suscripcion=new O;aiChat;historialChat;chatAbierto=!1;prompt="";loading=!1;chatMessages=[];postForm=new ee({titulo:new d("",s.compose([s.required,s.minLength(1)])),slug:new d("",s.compose([s.required,s.minLength(1)])),contenido:new d("",s.minLength(1)),categoria:new d(null),imagen:new d(null,s.minLength(1)),estado:new d("borrador",s.compose([s.required,s.minLength(1)])),keywords:new d("",s.minLength(1)),metadescripcion:new d("",s.minLength(1))});ngOnInit(){this.title.setTitle("Nueva entrada < Cl\xEDnica veterinaria La Huella"),this.getCategories(),this.responsiveDesign()}ngOnDestroy(){this.dialogService.closeAll(),this.suscripcion.unsubscribe()}getCategories(){this.categoriasService.getCategories().subscribe({next:o=>{this.categorias=o.data},error:o=>{o.status===404?this.snackbar.open("Categor\xEDas no encontradas.","Aceptar",{duration:3e3}):this.snackbar.open("Error al obtener las categor\xEDas.","Aceptar",{duration:3e3})}})}crearPost(){if(this.postForm.valid){let o={titulo:this.postForm.value.titulo||"",slug:this.postForm.value.slug||"",contenido:this.postForm.value.contenido||"",categoriaId:this.postForm.value.categoria||null,imagen:this.postForm.value.imagen||null,estado:this.postForm.value.estado||"borrador",keywords:this.postForm.value.keywords||"",metadescripcion:this.postForm.value.metadescripcion||""};this.postService.postPost(o).subscribe({next:t=>{this.snackbar.open("Post creado.","Aceptar",{duration:3e3}),this.router.navigate([`admin/blog/${t.data}/editar`])},error:t=>{t.status===422?this.snackbar.open("Los campos del post no son correctos.","Aceptar",{duration:3e3}):this.snackbar.open("Ha ocurrido un error.","Aceptar",{duration:3e3})}})}}enviarImagen(o){let t=o.target;if(t?.files?.[0]){let r=t.files[0],l=new FileReader;l.addEventListener("load",()=>{this.postForm.get("imagen")?.setValue(l.result)}),l.readAsDataURL(r)}}abrirAiChat(){return w(this,null,function*(){let o="Asistente IA",t="no-scroll-dialog",r={right:this.positionDialogueRight,bottom:"5rem"},l=!1;this.chatAbierto=!0,yield this.dialogService.openDialog({html:this.aiChat,title:o,position:r,hasBackdrop:l,panelClass:t}),this.chatAbierto=!1})}responsiveDesign(){this.suscripcion=this.responsiveService.obtenerDispositivo().subscribe(o=>{o==="M\xF3vil"?this.positionDialogueRight="":this.positionDialogueRight="5rem"})}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=S({type:a,selectors:[["app-post-nuevo"]],viewQuery:function(t,r){if(t&1&&(M(xe,5),M(Me,5)),t&2){let l;P(l=y())&&(r.aiChat=l.first),P(l=y())&&(r.historialChat=l.first)}},standalone:!0,features:[L],decls:68,vars:9,consts:[["autosize","cdkTextareaAutosize"],["fileInput",""],["AIchat",""],[1,"encabezado"],["routerLink","/admin/blog"],[1,"post-data",3,"formGroup"],[1,"post-content"],[1,"input-border"],[1,"field-full-width"],["matInput","","type","text","formControlName","titulo"],["matInput","","type","text","formControlName","slug","placeholder","El slug debe ser \xFAnico."],["matInput","","formControlName","contenido","cdkTextareaAutosize","","cdkAutosizeMinRows","10","cdkAutosizeMaxRows","10"],["matInput","","type","text","formControlName","keywords","placeholder","Palabras clave separadas por coma."],["matInput","","formControlName","metadescripcion","placeholder","Resumen corto del contenido de la entrada. No puede tener m\xE1s de 160 caracteres.","cdkTextareaAutosize","","cdkAutosizeMinRows","5","cdkAutosizeMaxRows","10"],[1,"post-attributes"],["appearance","fill"],[1,"fileUploadContainer",3,"ngStyle"],[4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","fxLayoutGap","10px",4,"ngIf"],["type","file","multiple","multiple","accept","image/*",1,"fileInput",3,"change"],["matInput","","formControlName","imagen","readonly","",3,"hidden"],["formControlName","categoria","ngDefaultControl",""],["required","","formControlName","estado","ngDefaultControl",""],["value","publicado"],["value","borrador"],["mat-flat-button","","type","submit",1,"btn-submit",3,"click"],[1,"btn-ai",3,"click","disabled"],["fontIcon","smart_toy",1,"ai-icon"],[3,"src"],["mat-icon-button","",1,"deleteButton",3,"click"],["fxLayout","column","fxLayoutAlign","center center","fxLayoutGap","10px"],[2,"opacity","60%"],["mat-raised-button","",2,"width","100%","opacity","80%","color","var(--lightbrown)"],[2,"margin","20px"],[3,"value"]],template:function(t,r){if(t&1){let l=x();n(0,"main")(1,"section",3)(2,"h1"),i(3,"Nueva entrada"),e(),n(4,"a",4),i(5,"\u2190 Volver atr\xE1s"),e()(),n(6,"form",5)(7,"section",6)(8,"div",7)(9,"mat-form-field",8)(10,"mat-label"),i(11,"T\xEDtulo"),e(),c(12,"input",9),e()(),n(13,"div",7)(14,"mat-form-field",8)(15,"mat-label"),i(16,"Slug"),e(),c(17,"input",10),e()(),n(18,"div",7)(19,"mat-form-field",8)(20,"mat-label"),i(21,"Contenido de la entrada"),e(),c(22,"textarea",11,0),e()(),n(24,"div",7)(25,"h2"),i(26,"SEO"),e(),n(27,"mat-form-field",8)(28,"mat-label"),i(29,"Palabras clave"),e(),c(30,"input",12),e(),n(31,"mat-form-field",8)(32,"mat-label"),i(33,"Meta descripci\xF3n"),e(),c(34,"textarea",13,0),e()()(),n(36,"aside",14)(37,"div",7)(38,"mat-form-field",15)(39,"mat-label"),i(40,"Imagen"),e(),n(41,"div",16),C(42,we,5,1,"ng-container",17)(43,Oe,7,0,"div",18),n(44,"input",19,1),h("change",function(_){return g(l),f(r.enviarImagen(_))}),e()(),c(46,"input",20),e()(),n(47,"div",7)(48,"mat-form-field",8)(49,"mat-label"),i(50,"Categor\xEDa"),e(),n(51,"mat-select",21),C(52,Ee,2,0),e()()(),n(53,"div",7)(54,"mat-form-field",8)(55,"mat-label"),i(56,"Estado"),e(),n(57,"mat-select",22)(58,"mat-option",23),i(59,"Publicado"),e(),n(60,"mat-option",24),i(61,"Borrador"),e()()(),n(62,"button",25),h("click",function(){return g(l),f(r.crearPost())}),i(63,"Guardar"),e()()()(),n(64,"button",26),h("click",function(){return g(l),f(r.abrirAiChat())}),c(65,"mat-icon",27),e()(),C(66,ke,1,0,"ng-template",null,2,z)}t&2&&(m(6),p("formGroup",r.postForm),m(35),p("ngStyle",T(7,ye,r.postForm.get("imagen").value?"5px":"20px")),m(),p("ngIf",r.postForm.get("imagen").value),m(),p("ngIf",!r.postForm.get("imagen").value),m(3),p("hidden",!0),m(6),k(r.categorias?52:-1),m(12),p("disabled",r.chatAbierto))},dependencies:[re,te,X,Y,Z,ie,ne,oe,ae,B,V,U,G,me,se,le,pe,ce,W,ue,de,Q,K,J,j,$,ve],styles:['@charset "UTF-8";main[_ngcontent-%COMP%]{margin:0 2rem}.encabezado[_ngcontent-%COMP%]{margin:1rem 0}.encabezado[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:var(--lengthMd1);color:var(--lightbrown)}h1[_ngcontent-%COMP%]{font-size:var(--lengthLg1);color:#000}.post-data[_ngcontent-%COMP%]{display:flex;gap:2rem}@media (max-width: 767px){.post-data[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}}.input-border[_ngcontent-%COMP%]{padding:1rem 1rem 0;margin-bottom:1rem;border:1px solid var(--lightbrown);background-color:#fff}.field-full-width[_ngcontent-%COMP%]{width:100%}.post-content[_ngcontent-%COMP%]{width:70%}@media (max-width: 767px){.post-content[_ngcontent-%COMP%]{width:100%}}.post-attributes[_ngcontent-%COMP%]{width:30%}@media (max-width: 767px){.post-attributes[_ngcontent-%COMP%]{width:100%}}.input-border[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:1rem}.input-border[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:-webkit-fill-available}.fileUploadContainer[_ngcontent-%COMP%]{padding:10px;display:flex;flex-direction:column;margin:0 auto;width:auto;height:150px;border:dashed 1px #979797;text-align:center;justify-content:center}.fileUploadContainer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block;margin-left:auto;margin-right:auto;max-height:100%;max-width:100%}.fileUploadContainer[_ngcontent-%COMP%]   .noImageContainet[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:11px}.fileUploadContainer[_ngcontent-%COMP%]   .noImageContainet[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:11px}.fileUploadContainer[_ngcontent-%COMP%]   .deleteButton[_ngcontent-%COMP%]{position:absolute;z-index:10;top:0;inset-inline-end:-10px;opacity:50%;color:red}.fileUploadContainer[_ngcontent-%COMP%]   .fileInput[_ngcontent-%COMP%]{position:absolute;z-index:9;opacity:0;height:100%;width:100%;left:0;top:0;cursor:pointer}button.btn-submit[_ngcontent-%COMP%]{background-color:var(--lightbrown);color:#fff;margin-bottom:1rem}.btn-ai[_ngcontent-%COMP%]{position:fixed;bottom:0;right:0;margin:0 2.5rem 1.5rem 0}.ai-icon[_ngcontent-%COMP%]{transform:scale(2);color:var(--dark);filter:drop-shadow(0 0 1px rgba(0,0,0,.8))}.chat-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-grow:1;background-color:#f5f5f5;padding:20px;height:90vh}.mat-dialog-container[_ngcontent-%COMP%]{overflow-y:hidden}.chat-history[_ngcontent-%COMP%]{flex-grow:1;overflow-y:auto;padding:10px;height:50vh;margin:2rem 0}.chat-message[_ngcontent-%COMP%]{margin-bottom:10px;display:flex;flex-direction:column}.chat-message.sent[_ngcontent-%COMP%]{justify-content:flex-end;align-items:flex-start}.chat-message.received[_ngcontent-%COMP%]{justify-content:flex-start;align-items:flex-end}.chat-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:10px;border-radius:5px;background-color:#fff;box-shadow:0 1px 3px #0000001a}.chat-message.sent[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{background-color:#e0e0e0}.chat-inputs[_ngcontent-%COMP%]{display:flex;gap:1rem;position:sticky;bottom:0}#message-input[_ngcontent-%COMP%]{flex-grow:1;padding:10px;border:1px solid #ccc;border-radius:5px}#send-button[_ngcontent-%COMP%]{padding:10px 20px;background-color:var(--lightbrown);color:#fff;border:none;border-radius:5px;cursor:pointer}.responses[_ngcontent-%COMP%]{padding:0 .5rem;white-space:pre-line!important}.messages[_ngcontent-%COMP%]{clear:both;border:1px solid rgba(0,0,0,.1098039216);padding:10px;border-radius:10px;font-size:14px;line-height:2;font-style:italic;margin-bottom:1rem}.bot-message[_ngcontent-%COMP%]{background-color:var(--lightbrown);color:#fff;text-align:start;float:left;margin-bottom:1rem}.user-message[_ngcontent-%COMP%]{text-align:end;float:right;margin-bottom:1rem}.blue[_ngcontent-%COMP%]{color:#00f;background:#0000ff24}.green[_ngcontent-%COMP%]{color:green;background:#80808017}#send-button[_ngcontent-%COMP%]:disabled{background-color:gray;cursor:not-allowed}.pensando[_ngcontent-%COMP%]{text-align:center;padding-bottom:1rem;animation:_ngcontent-%COMP%_pensando-animation 1s infinite ease-in-out}@keyframes _ngcontent-%COMP%_pensando-animation{0%{opacity:.2}50%{opacity:.5}to{opacity:.2}}']})};export{_e as PostNuevoComponent};

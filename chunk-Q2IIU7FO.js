import{a as Y,b as Z}from"./chunk-TP35GJ2Y.js";import"./chunk-IZUREK7C.js";import"./chunk-QBB5J64S.js";import{a as ee}from"./chunk-4KGD2F2G.js";import{a as W,b as X}from"./chunk-6IJVIIZO.js";import"./chunk-NAR25S56.js";import"./chunk-VCCA6JQD.js";import"./chunk-FFMKZHPZ.js";import{a as U}from"./chunk-HCF5RDTS.js";import{c as J,d as K}from"./chunk-3RE7YTIY.js";import{a as H,e as j,f as $}from"./chunk-Y6YWBKM7.js";import{b as R,d as x,f as V,g as k,h as y,j as M,l as Q,o as A,p as B,q as G,r as L,s as z}from"./chunk-Q674NIMA.js";import"./chunk-MUSOTDIH.js";import{a as I,c as q}from"./chunk-7YSBFMG3.js";import"./chunk-I2N33OYR.js";import"./chunk-CARY4E7O.js";import{j as N}from"./chunk-EKD5RMQ3.js";import{$b as C,Eb as O,Jb as l,Kb as n,Lb as g,Pb as E,Sb as S,Ub as u,_b as p,ac as b,bb as m,cb as F,e as w,ec as s,ga as c,gc as T,ka as D,mc as P,ta as h,tb as _,ua as v,vc as f,yb as d}from"./chunk-X7VXIKXH.js";var ae=["contentEditar"],ie=["contentEliminar"],re=["contentEliminarSeleccion"];function oe(r,t){if(r&1){let e=E();l(0,"app-datatable",12),S("selectionChange",function(i){h(e);let o=u();return v(o.onSelectionChange(i))}),n()}if(r&2){let e=u();d("columns",e.columns)("displayedColumns",e.displayedColumns)("data",e.categorias)("buttons",e.botones)("eliminarSeleccionados",e.deleteSeleccionCategorias.bind(e))}}function ne(r,t){r&1&&(l(0,"p"),s(1,"No hay categor\xEDas."),n())}function le(r,t){if(r&1&&(l(0,"div",13)(1,"form",8)(2,"mat-form-field",9)(3,"mat-label"),s(4,"Nombre"),n(),g(5,"input",14),n()()()),r&2){let e=u();m(),d("formGroup",e.editarCategoriaForm)}}function se(r,t){if(r&1&&(l(0,"div",15),s(1),n()),r&2){let e=u();m(),T(' \xBFEst\xE1s seguro de querer eliminar la categor\xEDa "',e.categoria.nombre,'"? ')}}function me(r,t){r&1&&(l(0,"div",16),s(1," \xBFEst\xE1s seguro de querer las categor\xEDas seleccionadas? "),g(2,"br"),l(3,"span",17),s(4,"\xA1OJO! Si has pulsado el bot\xF3n para seleccionar todo, se eliminar\xE1n todas las categor\xEDas, incluidas aquellas que no aparezcan en la vista actual."),n()())}var te=class r{constructor(t){this.dialogService=t}categoryService=c(ee);snackbar=c(U);datatableService=c(Y);categorias=[];categoria={};columns=["nombre"];displayedColumns=["select",...this.columns,"acciones"];selectedIds=[];suscripcion=new w;title=c(N);botones=[{id:1,nombre:"Editar",class:"editar",accion:t=>this.modalEditarCategoria(t)},{id:2,nombre:"Eliminar",class:"danger",accion:t=>this.modalDeleteCategoria(t)}];modalEditar;modalEliminar;modalEliminarSeleccion;crearCategoriaForm=new y({nombre:new M("",x.required)});editarCategoriaForm=new y({nombre_editar:new M("",x.required)});ngOnInit(){this.title.setTitle("Categor\xEDas < Cl\xEDnica veterinaria La Huella"),this.getCategorias(),this.suscripcion=this.categoryService.refresh$.subscribe(()=>{this.getCategorias()})}ngOnDestroy(){this.suscripcion.unsubscribe()}getCategorias(){this.categoryService.getCategories().subscribe({next:t=>{this.categorias=t.data},error:t=>{console.error(t)}})}postCategoria(){if(this.crearCategoriaForm.valid){let t={nombre:this.crearCategoriaForm.value.nombre||""};this.categoryService.postCategory(t).subscribe({next:e=>{this.snackbar.open("Categor\xEDa creada.","Aceptar",{duration:3e3})},error:e=>{console.error(e)}})}}modalEditarCategoria(t){let e="Editar categor\xEDa",a="guardar",i="cancelar";this.categoryService.getCategory(t).subscribe(o=>{this.editarCategoriaForm.patchValue({nombre_editar:o.data[0].nombre})}),this.dialogService.openDialog({html:this.modalEditar,title:e,btnClass:a,btnCancel:i}).then(o=>{o&&this.editarCategoriaForm.valid&&this.editarCategoria(t)})}editarCategoria(t){let e={nombre:this.editarCategoriaForm.value.nombre_editar||""};this.categoryService.updateCategory(t,e).subscribe({next:a=>{this.snackbar.open("Categor\xEDa actualizada.","Aceptar",{duration:3e3})},error:a=>{console.error(a)}})}modalDeleteCategoria(t){let e="Eliminar categor\xEDa",a="eliminar",i="cancelar";this.categoryService.getCategory(t).subscribe(o=>{this.categoria=o.data[0]}),this.dialogService.openDialog({html:this.modalEliminar,title:e,btnClass:a,btnCancel:i}).then(o=>{o&&this.deleteCategoria(t)})}deleteCategoria(t){this.categoryService.deleteCategory(t).subscribe({next:e=>{this.snackbar.open("Categor\xEDa eliminada.","Aceptar",{duration:3e3})},error:e=>{console.error(e)}})}deleteSeleccionCategorias(){this.dialogService.openDialog({html:this.modalEliminarSeleccion,title:"Eliminar categor\xEDas",btnClass:"eliminar",btnCancel:"cancelar"}).then(i=>{i&&this.categoryService.deleteCategories(this.selectedIds).subscribe({next:o=>{this.snackbar.open("Categor\xEDas eliminadas.","Aceptar",{duration:3e3}),this.datatableService._observable$.next()},error:o=>{console.error(o)}})})}onSelectionChange(t){this.selectedIds=t}static \u0275fac=function(e){return new(e||r)(F(X))};static \u0275cmp=D({type:r,selectors:[["app-categorias"]],viewQuery:function(e,a){if(e&1&&(p(ae,5),p(ie,5),p(re,5)),e&2){let i;C(i=b())&&(a.modalEditar=i.first),C(i=b())&&(a.modalEliminar=i.first),C(i=b())&&(a.modalEliminarSeleccion=i.first)}},standalone:!0,features:[P],decls:25,vars:3,consts:[["contentEditar",""],["contentEliminar",""],["contentEliminarSeleccion",""],[1,"encabezado","flex","flex-row","items-center","gap-6"],[1,"categorias"],[1,"tabla-categorias"],[3,"columns","displayedColumns","data","buttons","eliminarSeleccionados"],[1,"nueva-categoria"],[1,"categoria-form",3,"formGroup"],[1,"example-full-width"],["matInput","","placeholder","Nombre de la categor\xEDa","formControlName","nombre","ngDefaultControl","","required",""],["mat-stroked-button","","type","submit",1,"nuevo",3,"click","disabled"],[3,"selectionChange","columns","displayedColumns","data","buttons","eliminarSeleccionados"],[1,"modalEditar"],["matInput","","placeholder","Nombre de la categor\xEDa","formControlName","nombre_editar","ngDefaultControl","","required",""],[1,"modalEliminar"],[1,"modalEliminarSeleccion"],[1,"caution"]],template:function(e,a){if(e&1){let i=E();l(0,"main")(1,"section",3)(2,"h1"),s(3,"Categor\xEDas"),n()(),l(4,"section",4)(5,"div",5),_(6,oe,1,5,"app-datatable",6)(7,ne,2,0,"p"),n(),l(8,"div",7)(9,"h2"),s(10,"A\xF1adir nueva categor\xEDa"),n(),l(11,"form",8)(12,"mat-form-field",9)(13,"mat-label"),s(14,"Nombre"),n(),g(15,"input",10),n(),g(16,"br"),l(17,"button",11),S("click",function(){return h(i),v(a.postCategoria())}),s(18,"Guardar"),n()()()()(),_(19,le,6,1,"ng-template",null,0,f)(21,se,2,1,"ng-template",null,1,f)(23,me,5,0,"ng-template",null,2,f)}e&2&&(m(6),O(a.categorias?6:7),m(5),d("formGroup",a.crearCategoriaForm),m(6),d("disabled",!a.crearCategoriaForm.valid))},dependencies:[Z,q,I,$,j,H,K,J,W,z,Q,R,V,k,G,A,B,L],styles:["main[_ngcontent-%COMP%]{margin:0 2rem}.encabezado[_ngcontent-%COMP%]{margin:1rem 0}h1[_ngcontent-%COMP%]{font-size:var(--lengthLg1)}.categorias[_ngcontent-%COMP%]{display:flex;gap:2rem}@media (max-width: 1023px){.categorias[_ngcontent-%COMP%]{flex-direction:column}}@media (min-width: 1024px){.categorias[_ngcontent-%COMP%]{flex-direction:row}}@media (min-width: 1024px){.tabla-categorias[_ngcontent-%COMP%]{min-width:60%}}@media (min-width: 1024px){.nueva-categorias[_ngcontent-%COMP%]{width:40%}}.nueva-categoria[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{margin:2rem 0}button.nuevo[_ngcontent-%COMP%]{color:var(--dark)}.categoria-form[_ngcontent-%COMP%]{min-width:150px;width:100%!important}@media (min-width: 1024px){.categoria-form[_ngcontent-%COMP%]{min-width:300px}}@media (min-width: 1440px){.categoria-form[_ngcontent-%COMP%]{min-width:400px}}.example-full-width[_ngcontent-%COMP%]{width:100%}.caution[_ngcontent-%COMP%]{color:red}"]})};export{te as CategoriasComponent};
